<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<title>Aziz, Light! &middot; Having fun with Applescript and Terminal.app</title>
	<meta name="description" content="Aziz Light's blog." />
	<meta name="author" content="Aziz Light" />
	
	<link rel="stylesheet" href="/css/style.css" />

	
	<!-- Pygments syntax highlighting colors -->
	<link rel="stylesheet" href="/css/syntax.css" />
</head>
<body>
	<div id="page-wrap">
		<div id="header">
			<h1 id="blog-title"><a href="/" title="Aziz, Light!">Aziz, Light<span>!</span></a></h1>
		</div>
		
		<div id="main-content">
			<div class="post">
	<h2 class="title">Having fun with Applescript and Terminal.app</h2>
	<div class="date">30 Jun 2010</div>
	<div class="content">
		<p>Last week-end I decided that I wanted to go back to learning a little bit of ruby for a couple of days. PHP can become pretty boring at times (PHP 5.3 changes that a bit, closures are cool), and besides I love learning new programming languages. Anyway, back to the subject, I usually use a <em>dark</em> theme for Terminal.app, sometimes I make it a bit transparent to increase luminosity. However, when using <em>irb</em>, I like to use a brighter theme (i.e.: white background). The crappy solution would be to use the mouse to open a new window with a different theme, I don&#8217;t want to do that. Instead, I have been researching a way to achieve my goal without touching the mouse, or leaving the terminal for that matter. There are a couple of solutions that involve AppleScript. But before we get into it, let me make a small observation on AppleScript:</p>

<p>I do not know how to use AppleScript very well at all but my understanding of it is that it basically simulates mouse gestures or keyboard shortcuts/sequences. In other words, in it&#8217;s most basic form, AppleScript lets you access menubar items without touching the mouse.</p>

<h3 id='open_a_new_terminalapp_window_using_applescript'>Open a new Terminal.app window using AppleScript</h3>

<p>First let&#8217;s do it with the mouse. Let&#8217;s open a new window with the <em>Basic</em> theme. To do so, you need to select the following menubar item:</p>

<blockquote>
<p>Shell &#9656; New Window &#9656; Basic</p>
</blockquote>

<p>The following AppleScript script will do the same thing:</p>
<div class='highlight'><pre><code class='applescript'><span class='k'>tell</span> <span class='nb'>application</span> <span class='s2'>&quot;Terminal&quot;</span> <span class='k'>to</span> <span class='nb'>activate</span>

<span class='k'>tell</span> <span class='nb'>application</span> <span class='s2'>&quot;System Events&quot;</span>
	<span class='k'>tell</span> <span class='nv'>process</span> <span class='s2'>&quot;Terminal&quot;</span>
		<span class='k'>tell</span> <span class='na'>menu</span> <span class='nb'>item</span> <span class='s2'>&quot;Basic&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='s2'>&quot;New Window&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nb'>item</span> <span class='s2'>&quot;New Window&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='s2'>&quot;Shell&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nv'>bar</span> <span class='nb'>item</span> <span class='s2'>&quot;Shell&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nv'>bar</span> <span class='mi'>1</span>
			<span class='nv'>click</span>
		<span class='k'>end</span> <span class='k'>tell</span>
	<span class='k'>end</span> <span class='k'>tell</span>
<span class='k'>end</span> <span class='k'>tell</span>
</code></pre>
</div>
<p class='label'>gist: <a href='http://gist.github.com/458179'>458179</a></p>

<p>Nice and easy. But what if you want to open several windows with each different color themes without touching the mouse? <strong>The solution:</strong> Window Groups</p>

<h3 id='open_a_window_group_using_applescript'>Open a Window Group using AppleScript</h3>

<p><strong>The first thing to do is to create a new window group</strong>.</p>

<ol>
<li>
<p>Close the terminal windows that you don&#8217;t want and open new ones with a different color theme, position them, resize them, enjoy yourself until you are fully satisfied.</p>
</li>

<li>
<p>Once you&#8217;re done, you need to save the current <em>state</em> of Terminal.app as a window group.</p>

<ul>
<li>To do so, click the <strong>Window &#9656; Save Windows as Group&#8230;</strong> menu bar item and give a name to your new window group. <br /><em>For the sake of this example, I will call the window group <strong>Basic</strong>.</em></li>
</ul>
</li>
</ol>

<p>To open the newly created window group, you need to click on the following menubar item:</p>

<blockquote>
<p>Window &#9656; Open Windows Group &#9656; Basic</p>
</blockquote>

<p>Here is the AppleScript version of that mouse gesture:</p>
<div class='highlight'><pre><code class='applescript'><span class='k'>tell</span> <span class='nb'>application</span> <span class='s2'>&quot;Terminal&quot;</span> <span class='k'>to</span> <span class='nb'>activate</span>

<span class='k'>tell</span> <span class='nb'>application</span> <span class='s2'>&quot;System Events&quot;</span>
	<span class='k'>tell</span> <span class='nv'>process</span> <span class='s2'>&quot;Terminal&quot;</span>
		<span class='k'>tell</span> <span class='na'>menu</span> <span class='nb'>item</span> <span class='s2'>&quot;Basic&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='s2'>&quot;Open Window Group&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nb'>item</span> <span class='s2'>&quot;Open Window Group&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='s2'>&quot;Window&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nv'>bar</span> <span class='nb'>item</span> <span class='s2'>&quot;Window&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nv'>bar</span> <span class='mi'>1</span>
			<span class='nv'>click</span>
		<span class='k'>end</span> <span class='k'>tell</span>
	<span class='k'>end</span> <span class='k'>tell</span>
<span class='k'>end</span> <span class='k'>tell</span>
</code></pre>
</div>
<p class='label'>gist: <a href='http://gist.github.com/458195'>458195</a></p>

<p>Now here is the most important question that remains unanswered:</p>

<blockquote>
<p>How can I use those scripts from within Terminal.app?</p>
</blockquote>

<h3 id='using_applescript_from_the_commandline'>Using AppleScript from the command-line</h3>

<p>Here are the steps to follow to use AppleScript scripts as shell scripts from the command-line. <em>Note that those step are to be repeated for each script.</em></p>

<p>First create a new file and <strong>on the first line</strong> copy the following code (called the <strong>shebang</strong>):</p>
<div class='highlight'><pre><code class='sh'><span class='c'>#!/usr/bin/osascript</span>
</code></pre>
</div>
<p>After that line (2nd line, 3rd line, 42nd line, it doesn&#8217;t matter as long as it is after the <strong>shebang</strong>), copy <strong>one</strong> AppleScript script and save the file somewhere in your path (i.e.: <code>~/bin</code>); give it a simple name with no extension and make it executable. <em>For the sake of this example I am going to call the file <strong>basic</strong></em></p>
<div class='highlight'><pre><code class='console'><span class='go'>chmod a+x basic</span>
</code></pre>
</div>
<p>You can now use your script from the command-line by typing its name:</p>
<div class='highlight'><pre><code class='console'><span class='go'>basic</span>
</code></pre>
</div>
<p>That&#8217;s it!</p>

<h3 id='other_ways_to_use_applescript_scripts_from_the_commandline'>Other ways to use AppleScript scripts from the command-line</h3>

<p>If the <strong>shebang</strong> method doesn&#8217;t work, then you are probably doing something wrong; <strong>check that the <em>shebang</em> is the first line in the script, that means no whitespace before!</strong> However, if you do not like that method, there are several other ways to do it that I will describe <em>very</em> briefly:</p>

<ul>
<li>Compile and save the individual scripts as <em>scripts</em> using the <em>AppleScript Editor</em> and run them from the command-line using the <code>osascript</code> command.</li>

<li>Create aliases to open the AppleScript scripts you want.</li>

<li>If you are using zsh you can use a suffix alias.</li>
</ul>

<h3 id='customize_the_applescript_scripts'>Customize the AppleScript scripts</h3>

<p>As you can see, the AppleScript syntax is pretty straightforward and easy to customize. However, there is an important detail you need to pay attention to: for each menu item you want to &#8220;select&#8221; you need to &#8220;duplicate&#8221; its name. A little example will probably make this statement a bit more clear. Let&#8217;s modify the first script so that it opens a new <em>Homebrew</em> tab; replace that line:</p>
<div class='highlight'><pre><code class='applescript'><span class='k'>tell</span> <span class='na'>menu</span> <span class='nb'>item</span> <span class='s2'>&quot;Basic&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='s2'>&quot;New Window&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nb'>item</span> <span class='s2'>&quot;New Window&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='s2'>&quot;Shell&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nv'>bar</span> <span class='nb'>item</span> <span class='s2'>&quot;Shell&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nv'>bar</span> <span class='mi'>1</span>
</code></pre>
</div>
<p>&#8230;with that line:</p>
<div class='highlight'><pre><code class='applescript'><span class='k'>tell</span> <span class='na'>menu</span> <span class='nb'>item</span> <span class='s2'>&quot;Homebrew&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='s2'>&quot;New Tab&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nb'>item</span> <span class='s2'>&quot;New Tab&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='s2'>&quot;Shell&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nv'>bar</span> <span class='nb'>item</span> <span class='s2'>&quot;Shell&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nv'>bar</span> <span class='mi'>1</span>
</code></pre>
</div>
<p>So you see, the names <code>&quot;New Tab&quot;</code> and <code>&quot;Shell&quot;</code> are repeated twice. Here is the full script:</p>
<div class='highlight'><pre><code class='applescript'><span class='k'>tell</span> <span class='nb'>application</span> <span class='s2'>&quot;Terminal&quot;</span> <span class='k'>to</span> <span class='nb'>activate</span>

<span class='k'>tell</span> <span class='nb'>application</span> <span class='s2'>&quot;System Events&quot;</span>
	<span class='k'>tell</span> <span class='nv'>process</span> <span class='s2'>&quot;Terminal&quot;</span>
		<span class='k'>tell</span> <span class='na'>menu</span> <span class='nb'>item</span> <span class='s2'>&quot;Homebrew&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='s2'>&quot;New Tab&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nb'>item</span> <span class='s2'>&quot;New Tab&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='s2'>&quot;Shell&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nv'>bar</span> <span class='nb'>item</span> <span class='s2'>&quot;Shell&quot;</span> <span class='k'>of</span> <span class='na'>menu</span> <span class='nv'>bar</span> <span class='mi'>1</span>
			<span class='nv'>click</span>
		<span class='k'>end</span> <span class='k'>tell</span>
	<span class='k'>end</span> <span class='k'>tell</span>
<span class='k'>end</span> <span class='k'>tell</span>
</code></pre>
</div>
<p class='label'>gist: <a href='http://gist.github.com/458239'>458239</a></p>

<p>To use this script on the command-line, just follow the instructions above&#9757;</p>

<h3 id='let_me_give_credit_where_credit_is_due'>Let me give credit where credit is due</h3>

<p><strong>frogor</strong> and <strong>Tomis</strong> from the <strong>#macosx</strong> channel on the <strong>Freenode</strong> network (irc.freenode.net) helped me a lot. In fact, they did all the work, the explaining, the coding, everything.</p>
	</div>
</div>
		</div>
		<div id="footer">
			<p><a href="/">Aziz, Light<span>!</span></a></p>
			
			<ul>
				<li><a href="http://twitter.com/aziz_light">http://twitter.com/aziz_light</a></li>
				<li><a href="http://github.com/AzizLight">http://github.com/AzizLight</a></li>
				<li><a href="http://forrst.com/-AzizLight">http://forrst.com/-AzizLight</a></li>
			</ul>
			
			<p class="go-up"><a href="#header">&#x2B06;</a></p>
			<p><a href="#">Feed</a></p>
		</div>
	</div>
</body>
</html>